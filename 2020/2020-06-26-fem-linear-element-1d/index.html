<!DOCTYPE html>
<html lang="en-us">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Jukka Aho (@ahojukka5)  | Toisen kertaluvun differentiaaliyhtälön ratkaisu elementtimenetelmällä</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    
    
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">


<script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>


<script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"
    onload="renderMathInElement(document.body);"></script>


    

    <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.1/css/bulma.min.css" />
    <link rel="stylesheet" href="https://ahojukka5.github.io/css/blog.css" />
    </head>
<body>

    
    <nav class="navbar is-fixed-top" role="navigation" aria-label="main navigation">
        <div class="navbar-brand">
            <a class="navbar-item" href="https://ahojukka5.github.io">Home</a>
        </div>
    </nav>
    

    
    <section class="hero is-info is-medium">
        <div class="hero-body" style="background-image: url(https://ahojukka5.github.io/img/bg-blog.jpg);">
            <div class="container has-text-centered">
                <br>
                <h1 class="title is-size-1">
                    
                        Toisen kertaluvun differentiaaliyhtälön ratkaisu elementtimenetelmällä
                    
                </h1>
                
            </div>
        </div>
    </section>


<div class="container">
    <div class="section">
    

<div class="columns">
    <div class="column is-9">
        <div class="tile is-child box">
            <div class="content">
                <p>Tarkastellaan differentiaaliyhtälön
<span  class="math">\(
u'' = 12x^2 - 36x + 18
\)</span>
ratkaisua reunaehdoilla $u(0) = 0$ ja $u(3) = 0$.</p>

<p>Tarkka ratkaisu löytyy integroimalla kaksi kertaa ja valitsemalla
integrointivakiot siten, että reunaehdot toteutuvat. Tarkka ratkaisu siis on
tiedossa, ja se on
<span  class="math">\(
u\left(x\right) = \left(x - 3\right)^{2} x^{2}.
\)</span></p>

<p>Haetaan differentiaaliyhtälölle likiratkaisu elementtimenetelmällä.
Ratkaisuprosessi lyhyesti kuvattuna menee niin, että kerrotaan
differentiaaliyhtälöä testifunktiolla $v \in \mathcal{V}$ sekä integroidaan
alueen yli.
<span  class="math">\(
\int u'' \cdot v \, \mathrm{d}x = \int fv \, \mathrm{d}x
\)</span></p>

<p>On hieman makuasia, pitäisikö ratkaista yhtälöä $-u'' = f$ vai $u'' = f$,
monesti mukavuussyistä käytetään miinusmerkkiä.</p>

<p>Ratkaisu perustuu osittaisintegrointiin, tai oikeastaan tulon derivointiin. On
nimittäin niin, että
<span  class="math">\(
\left(u'v\right)'=u''\cdot v+u'v'.
\)</span></p>

<p>Tästä nyt huomataan, että
<span  class="math">\(
u''\cdot v=\left(u'v\right)'-u'v'.
\)</span></p>

<p>Integroimalla alueen yli saadaan</p>

<p><span  class="math">\[
\int u''\cdot v\,\mathrm{d}x =\int\left[\left(u'v\right)'-u'v'\right]\,\mathrm{d}x
\]</span></p>

<p>Ensimmäinen termi voidaan integroida</p>

<p><span  class="math">\[
\int u''\cdot v\,\mathrm{d}x  =\left[u'v\right]_{x=x_{0}}^{x=x_{1}}-\int u'\cdot v'\,\mathrm{d}x
\]</span></p>

<p>Testifunktioavaruus $\mathcal{V}$ valitaan yleensä siten, että funktiot saavat
arvon 0 reunoilla, joka johtaa siihen, että sijoitustermi häviää.</p>

<p>Saadaan yhtälön heikko muoto eli energiamuoto: määrää $u\in\mathcal{U}$ siten että kaikille $v\in\mathcal{V}$
<span  class="math">\(
\int u'\cdot v'\,\mathrm{d}x = -\int fv\,\mathrm{d}x
\)</span></p>

<p>Ratkaisu etenee siten, että diskretoidaan ongelma ja valitaan diskretointiin
sopiva yriteratkaisu. Esimerkiksi väli $I = [0, 3]$ voidaan diskretoida niin,
että kuvataan väli $I_1 = [0, 2]$ yhdellä funktiolla ja väli $I_2 = [2, 3]$
toisella.</p>

<p>Yriteratkaisun $u<em>h(x)$ pitäisi nyt olla vähintäänkin sellainen, että sen derivaatta on olemassa, muuten tulee pelkkää nollaa. Sama pätee testifunktioihin $v$. Yksinkertaisin valinta on paloittain jatkuva lineaarinen funktio.
$$
u</em>{h}\left(x\right)=\begin{cases}
\alpha_{2}\phi_{2}^{\left(1\right)}\left(x\right) &amp; x\in I_{1}<br>
\alpha_{2}\phi_{1}^{\left(2\right)}\left(x\right) &amp; x\in I_{2}
\end{cases},
$$
missä</p>

<p><span  class="math">\[
\begin{alignedat}{2}
\phi_{2}^{\left(1\right)} & =\frac{1}{2}x\\
\phi_{1}^{\left(2\right)} & =3-x
\end{alignedat}
\]</span></p>

<p>Funktio siis saa arvon $\alpha_2$ kohdassa $x=2$, mitä on jäljellä keksiä mikä tuo tuntematon kerroin olisi. Kantafunktioiden derivaatat ovat</p>

<p><span  class="math">\[
\begin{alignedat}{2}
\frac{\mathrm{d}}{\mathrm{d}x}\phi_{2}^{\left(1\right)} &=\frac{1}{2} \\
\frac{\mathrm{d}}{\mathrm{d}x}\phi_{1}^{\left(2\right)} &=-1
\end{alignedat}
\]</span></p>

<p>Heikko muoto täytyy integroida kahdessa osassa. Kun sijoitetaan heikkoon muotoon, saadaan</p>

<p><span  class="math">\[
k_{22}^{\left(1\right)}+k_{11}^{\left(2\right)} =-f_{2}^{\left(1\right)}-f_{1}^{\left(2\right)},
\]</span></p>

<p>missä</p>

<p><span  class="math">\[
\begin{alignedat}{2}
k_{22}^{\left(1\right)} =\int_{I_{1}}\alpha_{2}\frac{1}{2}\cdot\frac{1}{2}\,\mathrm{d}x=\frac{1}{2}\alpha_{2} \\
k_{11}^{\left(2\right)} =\int_{I_{2}}\alpha_{2}\left(-1\right)\cdot\left(-1\right)\,\mathrm{d}x=\alpha_{2} \\
f_{2}^{\left(1\right)}  =\int_{I_{1}}\left(12x^{2}-36x+18\right)\frac{1}{2}x\,\mathrm{d}x=6 \\
f_{1}^{\left(2\right)}  =\int_{I_{2}}\left(12x^{2}-36x+18\right)\left(3-x\right)x\,\mathrm{d}x=0
\end{alignedat}
\]</span></p>

<p>Tästä voi ratkaista tuntemattoman kertoimen $\alpha<em>2$:
$$
\alpha</em>{2}=k_{2}^{-1}f_{2}=\frac{2}{3}\cdot6=4
$$</p>

            </div>
        </div>
    </div>
    <div class="column is-3">
        <div class="card">
    <div class="card-content">
        <h1 class="title is-5">Tags</h1>
        <div class="tags">
        
            <span class="tag"><a href="https://ahojukka5.github.io/tags/algorithms">algorithms</a></span>
        
            <span class="tag"><a href="https://ahojukka5.github.io/tags/autossh">autossh</a></span>
        
            <span class="tag"><a href="https://ahojukka5.github.io/tags/backup">backup</a></span>
        
            <span class="tag"><a href="https://ahojukka5.github.io/tags/bash">bash</a></span>
        
            <span class="tag"><a href="https://ahojukka5.github.io/tags/c&#43;&#43;">c&#43;&#43;</a></span>
        
            <span class="tag"><a href="https://ahojukka5.github.io/tags/deep-learning">deep-learning</a></span>
        
            <span class="tag"><a href="https://ahojukka5.github.io/tags/duplicity">duplicity</a></span>
        
            <span class="tag"><a href="https://ahojukka5.github.io/tags/filters">filters</a></span>
        
            <span class="tag"><a href="https://ahojukka5.github.io/tags/gmsh">gmsh</a></span>
        
            <span class="tag"><a href="https://ahojukka5.github.io/tags/julia">julia</a></span>
        
            <span class="tag"><a href="https://ahojukka5.github.io/tags/juliafem">juliafem</a></span>
        
            <span class="tag"><a href="https://ahojukka5.github.io/tags/jupyter-notebook">jupyter-notebook</a></span>
        
            <span class="tag"><a href="https://ahojukka5.github.io/tags/linux">linux</a></span>
        
            <span class="tag"><a href="https://ahojukka5.github.io/tags/lstm-networks">lstm-networks</a></span>
        
            <span class="tag"><a href="https://ahojukka5.github.io/tags/macro">macro</a></span>
        
            <span class="tag"><a href="https://ahojukka5.github.io/tags/metaprogramming">metaprogramming</a></span>
        
            <span class="tag"><a href="https://ahojukka5.github.io/tags/pandoc">pandoc</a></span>
        
            <span class="tag"><a href="https://ahojukka5.github.io/tags/parametric-simulations">parametric-simulations</a></span>
        
            <span class="tag"><a href="https://ahojukka5.github.io/tags/partial-differential-equations">partial-differential-equations</a></span>
        
            <span class="tag"><a href="https://ahojukka5.github.io/tags/performance">performance</a></span>
        
            <span class="tag"><a href="https://ahojukka5.github.io/tags/ssh-tunnel">ssh-tunnel</a></span>
        
            <span class="tag"><a href="https://ahojukka5.github.io/tags/symbolic-differentiation">symbolic-differentiation</a></span>
        
            <span class="tag"><a href="https://ahojukka5.github.io/tags/systemd">systemd</a></span>
        
            <span class="tag"><a href="https://ahojukka5.github.io/tags/vibration-data">vibration-data</a></span>
        
            <span class="tag"><a href="https://ahojukka5.github.io/tags/wrapping">wrapping</a></span>
        
        </div>          
    </div>
</div><br>
        <div class="card">
    <div class="card-content">
        <h1 class="title is-5">Recent posts</h1>
        
            <h1><a href="https://ahojukka5.github.io/2020/2020-06-26-fem-linear-element-1d/">Toisen kertaluvun differentiaaliyhtälön ratkaisu elementtimenetelmällä</a></h1>
            <time class="has-text-grey-light is-size-7">26 June 2020</time>
        
            <h1><a href="https://ahojukka5.github.io/2020/2020-06-23-julia-metaprogramming-macro-techniques/">Metaohjelmointia Julialla, tekniikoista</a></h1>
            <time class="has-text-grey-light is-size-7">23 June 2020</time>
        
            <h1><a href="https://ahojukka5.github.io/2020/2020-06-22-julia-metaprogramming-macro-techniques/">Metaohjelmointia Julialla, tekniikoista</a></h1>
            <time class="has-text-grey-light is-size-7">22 June 2020</time>
        
            <h1><a href="https://ahojukka5.github.io/2020/2020-06-19-julia-metaprogramming-symbolic-differentiation/">Metaohjelmointia Julialla: symbolinen derivointi</a></h1>
            <time class="has-text-grey-light is-size-7">19 June 2020</time>
        
            <h1><a href="https://ahojukka5.github.io/2020/2020-06-18-julia-metaprogramming-macros/">Julian makrot</a></h1>
            <time class="has-text-grey-light is-size-7">18 June 2020</time>
        
    </div>
</div>
    
<br>
                


    
<br>
        <div class="card">
    <div class="card-content">
        <h1 class="title is-5">Archives</h1>
        
            <a href="https://ahojukka5.github.io/archives/2020">2020</a> (13)<br>
        
            <a href="https://ahojukka5.github.io/archives/2019">2019</a> (4)<br>
        
    </div>
</div>

    </div>
</div>


    </div>
</div>

<footer class="footer has-background-grey-darker has-text-white">
    <div class="content has-text-centered">
        <p>
            <span class="icon is-large"><a href="https://twitter.com/" class="mysocial" rel="me"><i class="fab fa-twitter fa-3x"></i></a></span>&nbsp;&nbsp;
            <span class="icon is-large"><a href="https://www.youtube.com/" class="mysocial" rel="me"><i class="fab fa-youtube fa-3x"></i></a></span>&nbsp;&nbsp;
            <span class="icon is-large"><a href="https://github.com/" class="mysocial" rel="me"><i class="fab fa-github fa-3x"></i></a></span>&nbsp;&nbsp;
            <br><br>
            Copyright &copy; Jukka Aho (@ahojukka5) 2020 - Theme by <a href="https://jeffprod.com" class="mysocial">JeffProd.com</a>
            - <a class="mysocial" href="https://ahojukka5.github.io/about">About</a>
        </p>
    </div>
</footer>

<script defer src="https://use.fontawesome.com/releases/v5.1.0/js/all.js"></script>
</body>
</html>
