<!DOCTYPE html>
<html lang="en-us">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Jukka Aho (@ahojukka5)  | Toisen kertaluvun differentiaaliyhtälön ratkaisu elementtimenetelmällä</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    
    
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">


<script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>


<script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"
    onload="renderMathInElement(document.body);"></script>


    

    <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.1/css/bulma.min.css" />
    <link rel="stylesheet" href="https://ahojukka5.github.io/css/blog.css" />
    </head>
<body>

    
    <nav class="navbar is-fixed-top" role="navigation" aria-label="main navigation">
        <div class="navbar-brand">
            <a class="navbar-item" href="https://ahojukka5.github.io">Home</a>
        </div>
    </nav>
    

    
    <section class="hero is-info is-medium">
        <div class="hero-body" style="background-image: url(https://ahojukka5.github.io/img/bg-blog.jpg);">
            <div class="container has-text-centered">
                <br>
                <h1 class="title is-size-1">
                    
                        Toisen kertaluvun differentiaaliyhtälön ratkaisu elementtimenetelmällä
                    
                </h1>
                
            </div>
        </div>
    </section>


<div class="container">
    <div class="section">
    

<div class="columns">
    <div class="column is-9">
        <div class="tile is-child box">
            <div class="content">
                <p>Tarkastellaan toisen kertaluvun differentiaaliyhtälön ratkaisua Galerkinin menetelmällä joka paremmin tunnetaan elementtimenetelmänä. Tarkasteltavana on reuna-arvo-ongelma, jossa yhtälön reunaehtoja esiintyy yhtälön molemmissa päissä ja derivaatat ovat itse asiassa paikkaderivaattoja. Toinen tyyppi olisi alkuarvo-ongelma, jossa derivaatat ovat aikaderivaattoja, mutta siihen tehtävätyyppiin ei tässä nyt mennä.</p>
<p>Valitaan tarkasteltavaksi differentiaaliyhtälöksi <span id="eq:strong_form"><span class="math display">\[u&#39;&#39;=12x^{2}-36x+18,\qquad u\left(0\right)=u\left(3\right)=0,\qquad(1)\]</span></span> joka on itse asiassa differentiaaliyhtälön <span class="math display">\[
u&#39;&#39;&#39;&#39; = 24, \qquad u\left(0\right)=u&#39;\left(0\right)=u\left(3\right)=u&#39;\left(3\right)
\]</span> ratkaisu derivoituna kaksi kertaa. Voimme käyttää tätä samaa yhtälö myöhemmissä tutkimuksissa.</p>
<p>Tarkka ratkaisu löytyy integroimalla differentiaaliyhtälöä (eq. 1) kaksi kertaa ja valitsemalla integrointivakiot siten, että reunaehdot toteutuvat. Tarkka ratkaisu siis tiedetään, ja se on <span class="math display">\[u\left(x\right)=\left(x-3\right)^{2}x^{2}.\]</span> Tässä esimerkkitapauksessa ratkaisun löytäminen integroimalla oli triviaali toimenpide, mutta yleisesti ottaen osittaisdifferentiaaliyhtälöiden analyyttisiä ratkaisuja ei tunneta ja numeerisia menetelmiä pitää käyttää.</p>
<p>Tarkka ratkaisu on esitetty kuvassa <a href="#fig:sol_acc" data-reference-type="ref" data-reference="fig:sol_acc">1</a>. Tarkan ratkaisun voi varmistaa derivoimalla yhtälöä kaksi kertaa sekä tarkastamalla, että reunaehdot toteutuvat.</p>
<figure>
<img src="sol_acc.svg" id="fig:sol_acc" alt="" /><figcaption>Figure 1: <span id="fig:sol_acc" label="fig:sol_acc"></span>Differentiaaliyhtälön tarkka ratkaisu.</figcaption>
</figure>
<p>Haetaan differentiaaliyhtälölle likiratkaisu elementtimenetelmällä. Ratkaisuprosessi lyhyesti kuvattuna menee niin, että kerrotaan differentiaaliyhtälöä testifunktiolla <span class="math inline">\(v\in\mathcal{V}\)</span> sekä integroidaan alueen yli: <span class="math display">\[\int u&#39;&#39;\cdot v\,\mathrm{d}x=\int fv\,\mathrm{d}x.\]</span></p>
<p>On hieman makuasia, pitäisikö ratkaista yhtälöä <span class="math inline">\(-u&#39;&#39;=f\)</span> vai <span class="math inline">\(u&#39;&#39;=f\)</span>, monesti mukavuussyistä käytetään miinusmerkkiä. Tämä asia tulee ilmi myöhemmin.</p>
<p>Ratkaisu perustuu osittaisintegrointiin, tai oikeastaan tulon derivointiin. On nimittäin niin, että <span class="math display">\[\left(u&#39;v\right)&#39;=u&#39;&#39;\cdot v+u&#39;v&#39;.\]</span></p>
<p>Tästä nyt huomataan, että <span class="math display">\[u&#39;&#39;\cdot v=\left(u&#39;v\right)&#39;-u&#39;v&#39;.\]</span></p>
<p>Integroimalla yhtälöä saadaan <span class="math display">\[\begin{aligned} \int u&#39;&#39;\cdot v\,\mathrm{d}x &amp;
=\int\left[\left(u&#39;v\right)&#39;-u&#39;v&#39;\right]\,\mathrm{d}x\\
 &amp; =\left[u&#39;v\right]_{x=x_{0}}^{x=x_{1}}-\int u&#39;\cdot v&#39;\,\mathrm{d}x.\end{aligned}\]</span></p>
<p>Testifunktioavaruus <span class="math inline">\(\mathcal{V}\)</span> valitaan yleensä siten, että funktiot <span class="math inline">\(v_{i}\in\mathcal{V}\)</span> häviävät reunoilla, ts. <span class="math inline">\(v_{i}\left(x_{0}\right)=v_{i}\left(x_{1}\right)=0\)</span>, joka johtaa siihen, että sijoitustermi häviää.</p>
<p>Saadaan yhtälön heikko muoto<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> eli energiamuoto: määrää <span class="math inline">\(u\in\mathcal{U}\)</span> siten että kaikille <span class="math inline">\(v\in\mathcal{V}\)</span> <span class="math display">\[\int u&#39;\cdot v&#39;\,\mathrm{d}x=-\int fv\,\mathrm{d}x.\]</span></p>
<p>Mikäli ratkaistavana olisi ollut yhtälö <span class="math inline">\(-u&#39;&#39;=f\)</span>, ei heikossa muodossa olisi tuota miinusmerkkiä. Monesti tämä Poissonin yhtälö kirjallisuudessa esitetäänkin muodossa <span class="math display">\[-\Delta u=f,\]</span> missä Laplacen operaattori<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> <span class="math inline">\(\Delta\)</span> määritellään <span class="math display">\[\Delta u=\nabla\cdot\nabla u\]</span> ja <span class="math inline">\(\nabla\)</span> on funktion gradientti.</p>
<p>Lisäksi matemaattisessa kirjallisuudessa heikko muoto esitetään yleensä kanonisessa muodossa: määrää <span class="math inline">\(u\in\mathcal{U}\)</span> siten, että <span class="math display">\[a\left(u,v\right)=l\left(v\right)\qquad\forall v\in\mathcal{V},\]</span> missä <span class="math display">\[\begin{aligned} a\left(u,v\right) &amp; =\int u&#39;\cdot v&#39;\,\mathrm{d}x,\\
l\left(v\right) &amp; =\int fv\,\mathrm{d}x.\end{aligned}\]</span></p>
<p>Elementtimenetelmällä ratkaisu etenee siten, että diskretoidaan ongelma ja valitaan diskretointiin sopiva yriteratkaisu. Esimerkiksi väli <span class="math inline">\(\Omega=[0,3]\)</span> voidaan diskretoida niin, että kuvataan väli <span class="math inline">\(\Omega^{\left(1\right)}=[0,2]\)</span> yhdellä funktiolla <span class="math inline">\(\phi_{1}\left(x\right)\)</span> ja väli <span class="math inline">\(\Omega^{\left(2\right)}=[2,3]\)</span> toisella.</p>
<p>Tavoitteena on keksiä likiratkaisu <span class="math inline">\(u_{h}(x)\)</span> joka toteuttaisi yhtälön heikon muodon. Ratkaisussa käytettävät muotofunktiot pitää olla vähintään <span class="math inline">\(\mathcal{C}^{0}\)</span>-jatkuvia, että heikon muodon vasemman puoleisesta termistä tulee jotakin nollasta poikkeavaa.</p>
<p>Yksinkertaisin valinta on siis paloittain jatkuva lineaarinen funktio. Likiratkaisu alkuperäiseen ongelmaan on <span class="math display">\[u_{h}\left(x\right)=\begin{cases}
\alpha_{2}\phi_{2}^{\left(1\right)}\left(x\right) &amp; x\in\Omega^{\left(1\right)},\\
\alpha_{2}\phi_{1}^{\left(2\right)}\left(x\right) &amp; x\in\Omega^{\left(2\right)},
\end{cases}\]</span> missä muotofunktiot ovat: <span class="math display">\[\begin{alignedat}{1}\phi_{2}^{\left(1\right)} &amp; =\frac{1}{2}x,\\
\phi_{1}^{\left(2\right)} &amp; =3-x.
\end{alignedat}\]</span></p>
<p>Muotofunktiot ovat perinteinen hattufunktio, joka saa arvon 1 solmupisteessä 2, siis kohdassa <span class="math inline">\(x=2\)</span>. Muotofunktiot on esitetty kuvassa fig. 2. Mitä on jäljellä keksiä mikä tuo tuntematon kerroin <span class="math inline">\(\alpha_{2}\)</span> olisi.</p>
<figure>
<img src="sol_basis.svg" id="fig:sol_basis" alt="" /><figcaption>Figure 2: <span id="fig:sol_basis" label="fig:sol_basis"></span>Ratkaisuun käytettävät kantafunktiot.</figcaption>
</figure>
<p>Kantafunktioiden derivaatat ovat <span class="math display">\[\begin{alignedat}{1}\frac{\mathrm{d}}{\mathrm{d}x}\phi_{2}^{\left(1\right)} &amp; =\frac{1}{2},\\
\frac{\mathrm{d}}{\mathrm{d}x}\phi_{1}^{\left(2\right)} &amp; =-1.
\end{alignedat}\]</span></p>
<p>Heikko muoto täytyy integroida kahdessa osassa. Kun approksimaatiot sijoitetaan heikkoon muotoon ja lasketaan integraali, saadaan <span class="math display">\[k_{22}^{\left(1\right)}+k_{11}^{\left(2\right)}=-f_{2}^{\left(1\right)}-f_{1}^{\left(2\right)},\]</span> missä <span class="math display">\[\begin{aligned}
k_{22}^{\left(1\right)} &amp; =\int_{\Omega^{\left(1\right)}}\alpha_{2}\frac{\mathrm{d}}{\mathrm{d}x}\phi_{2}^{\left(1\right)}\cdot\frac{\mathrm{d}}{\mathrm{d}x}\phi_{2}^{\left(1\right)}\,\mathrm{d}x=\frac{1}{2}\alpha_{2,}\\
k_{11}^{\left(2\right)} &amp; =\int_{\Omega^{\left(2\right)}}\alpha_{2}\frac{\mathrm{d}}{\mathrm{d}x}\phi_{1}^{\left(2\right)}\cdot\frac{\mathrm{d}}{\mathrm{d}x}\phi_{1}^{\left(2\right)}\,\mathrm{d}x=\alpha_{2},\\
f_{2}^{\left(1\right)} &amp; =\int_{\Omega^{\left(1\right)}}f\phi_{2}^{\left(1\right)}\,\mathrm{d}x=6,\\
f_{1}^{\left(2\right)} &amp; =\int_{\Omega^{\left(2\right)}}f\phi_{1}^{\left(2\right)}\,\mathrm{d}x=0.\end{aligned}\]</span></p>
<p>Sijoittelemalla lukuarvoja saadaan <span class="math display">\[\begin{aligned}
k_{22}^{\left(1\right)} &amp; =\alpha_{2}\int_{0}^{2}\frac{1}{2}\cdot\frac{1}{2}\,\mathrm{d}x=\frac{1}{2}\alpha_{2,}\\
k_{11}^{\left(2\right)} &amp; =\alpha_{2}\int_{0}^{2}\left(-1\right)\cdot\left(-1\right)\,\mathrm{d}x=\alpha_{2},\\
f_{2}^{\left(1\right)} &amp; =\int_{2}^{3}\left(12x^{2}-36x+18\right)\frac{1}{2}x\,\mathrm{d}x=6,\\
f_{1}^{\left(2\right)} &amp; =\int_{2}^{3}\left(12x^{2}-36x+18\right)\left(3-x\right)x\,\mathrm{d}x=0.\end{aligned}\]</span></p>
<p>Tästä voi nyt ratkaista tuntemattoman kertoimen <span class="math inline">\(\alpha_{2}\)</span>: <span class="math display">\[\alpha_{2}=k_{2}^{-1}f_{2}=\frac{2}{3}\cdot6=4.\]</span></p>
<p>Niinpä <span class="math inline">\(u\)</span>:n likiratkaisu <span class="math inline">\(u_{h}\)</span> on <span class="math display">\[u_{h}\left(x\right)=\begin{cases}
2x &amp; x\in\Omega^{\left(1\right)},\\
12-4x &amp; x\in\Omega^{\left(2\right)}.
\end{cases}\]</span></p>
<p>Tarkan ratkaisun ja likiratkaisun vertailua on tehty kuvassa <a href="#fig:sol_fem" data-reference-type="ref" data-reference="fig:sol_fem">2</a>.</p>
<figure>
<img src="sol_fem.svg" id="fig:sol_fem" alt="" /><figcaption>Figure 3: <span id="fig:sol_fem" label="fig:sol_fem"></span>Differentiaaliyhtälön tarkan ratkaisun ja likiratkaisun vertailua.</figcaption>
</figure>
<p>Elementtimenetelmässä, tai tarkemmin sanottuna Galerkinin menetelmässä<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>, keskeinen ominaisuus on, että virhe on kohtisuorassa muotofunktioihin nähden, eli <span class="math display">\[a\left(u-u_{h},v\right)=0\]</span></p>
<p>Suoraan integroimalla voi todeta että näin todellakin on: <span class="math display">\[\begin{gathered}
\int_{0}^{2}\frac{\mathrm{d}}{\mathrm{d}x}\left(\left(x-3\right)^{2}x^{2}-2x\right)\cdot\frac{\mathrm{d}}{\mathrm{d}x}\left(\frac{1}{2}x\right)=0,\\
\int_{2}^{3}\frac{\mathrm{d}}{\mathrm{d}x}\left(\left(x-3\right)^{2}x^{2}-\left(12-4x\right)\right)\cdot\frac{\mathrm{d}}{\mathrm{d}x}\left(3-x\right)=0.\end{gathered}\]</span></p>
<p>Ratkaisu toimii, mutta siinä on muutamia hankaluuksia numeerista implementointia ajatellen. Eräs mielenkiintoinen kysymys on, kuinka näitä kantafunktioita ja niiden derivaattoja voidaan rakentaa tehokkaasti. Sitä käsitellään tulevissa kirjoituksissa.</p>
<section class="footnotes" role="doc-endnotes">
<hr />
<ol>
<li id="fn1" role="doc-endnote"><p><a href="https://en.wikipedia.org/wiki/Weak_formulation" class="uri">https://en.wikipedia.org/wiki/Weak_formulation</a><a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2" role="doc-endnote"><p><a href="https://en.wikipedia.org/wiki/Laplace_operator" class="uri">https://en.wikipedia.org/wiki/Laplace_operator</a><a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3" role="doc-endnote"><p><a href="https://en.wikipedia.org/wiki/Galerkin_method" class="uri">https://en.wikipedia.org/wiki/Galerkin_method</a><a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>
            </div>
        </div>
    </div>
    <div class="column is-3">
        <div class="card">
    <div class="card-content">
        <h1 class="title is-5">Tags</h1>
        <div class="tags">
        
            <span class="tag"><a href="https://ahojukka5.github.io/tags/algorithms">algorithms</a></span>
        
            <span class="tag"><a href="https://ahojukka5.github.io/tags/autossh">autossh</a></span>
        
            <span class="tag"><a href="https://ahojukka5.github.io/tags/backup">backup</a></span>
        
            <span class="tag"><a href="https://ahojukka5.github.io/tags/bash">bash</a></span>
        
            <span class="tag"><a href="https://ahojukka5.github.io/tags/basis-functions">basis-functions</a></span>
        
            <span class="tag"><a href="https://ahojukka5.github.io/tags/c&#43;&#43;">c&#43;&#43;</a></span>
        
            <span class="tag"><a href="https://ahojukka5.github.io/tags/data-types">data-types</a></span>
        
            <span class="tag"><a href="https://ahojukka5.github.io/tags/deep-learning">deep-learning</a></span>
        
            <span class="tag"><a href="https://ahojukka5.github.io/tags/duplicity">duplicity</a></span>
        
            <span class="tag"><a href="https://ahojukka5.github.io/tags/filters">filters</a></span>
        
            <span class="tag"><a href="https://ahojukka5.github.io/tags/finite-element-method">finite-element-method</a></span>
        
            <span class="tag"><a href="https://ahojukka5.github.io/tags/gmsh">gmsh</a></span>
        
            <span class="tag"><a href="https://ahojukka5.github.io/tags/julia">julia</a></span>
        
            <span class="tag"><a href="https://ahojukka5.github.io/tags/juliafem">juliafem</a></span>
        
            <span class="tag"><a href="https://ahojukka5.github.io/tags/jupyter-notebook">jupyter-notebook</a></span>
        
            <span class="tag"><a href="https://ahojukka5.github.io/tags/linux">linux</a></span>
        
            <span class="tag"><a href="https://ahojukka5.github.io/tags/lstm-networks">lstm-networks</a></span>
        
            <span class="tag"><a href="https://ahojukka5.github.io/tags/macro">macro</a></span>
        
            <span class="tag"><a href="https://ahojukka5.github.io/tags/metaprogramming">metaprogramming</a></span>
        
            <span class="tag"><a href="https://ahojukka5.github.io/tags/neural-networks">neural-networks</a></span>
        
            <span class="tag"><a href="https://ahojukka5.github.io/tags/pandoc">pandoc</a></span>
        
            <span class="tag"><a href="https://ahojukka5.github.io/tags/parametric-simulations">parametric-simulations</a></span>
        
            <span class="tag"><a href="https://ahojukka5.github.io/tags/partial-differential-equations">partial-differential-equations</a></span>
        
            <span class="tag"><a href="https://ahojukka5.github.io/tags/performance">performance</a></span>
        
            <span class="tag"><a href="https://ahojukka5.github.io/tags/ssh-tunnel">ssh-tunnel</a></span>
        
            <span class="tag"><a href="https://ahojukka5.github.io/tags/symbolic-differentiation">symbolic-differentiation</a></span>
        
            <span class="tag"><a href="https://ahojukka5.github.io/tags/systemd">systemd</a></span>
        
            <span class="tag"><a href="https://ahojukka5.github.io/tags/vibration-data">vibration-data</a></span>
        
            <span class="tag"><a href="https://ahojukka5.github.io/tags/wrapping">wrapping</a></span>
        
        </div>          
    </div>
</div><br>
        <div class="card">
    <div class="card-content">
        <h1 class="title is-5">Recent posts</h1>
        
            <h1><a href="https://ahojukka5.github.io/2020/2020-07-07-neural-networks-hello-world/">Neuroverkkojen matematiikkaa</a></h1>
            <time class="has-text-grey-light is-size-7">6 July 2020</time>
        
            <h1><a href="https://ahojukka5.github.io/2020/2020-07-05-julia-type-conversions/">Konversioita Julian datatyyppien välillä</a></h1>
            <time class="has-text-grey-light is-size-7">5 July 2020</time>
        
            <h1><a href="https://ahojukka5.github.io/2020/2020-07-01-fem-hermite-element-1d/">Elementtimenetelmän kantafunktioiden laskeminen</a></h1>
            <time class="has-text-grey-light is-size-7">1 July 2020</time>
        
            <h1><a href="https://ahojukka5.github.io/2020/2020-06-26-fem-linear-element-1d/">Toisen kertaluvun differentiaaliyhtälön ratkaisu elementtimenetelmällä</a></h1>
            <time class="has-text-grey-light is-size-7">26 June 2020</time>
        
            <h1><a href="https://ahojukka5.github.io/2020/2020-06-22-julia-metaprogramming-macro-techniques/">Metaohjelmointia Julialla, tekniikoista</a></h1>
            <time class="has-text-grey-light is-size-7">22 June 2020</time>
        
    </div>
</div>
    
<br>
                
  



<div class="card">
    <div class="card-content">
        <h1 class="title is-5">Related posts</h1>
      
      
            <h1><a href="https://ahojukka5.github.io/2020/2020-07-01-fem-hermite-element-1d/">Elementtimenetelmän kantafunktioiden laskeminen</a></h1>
            <time class="has-text-grey-light is-size-7">1 July 2020</time>
      
    </div>
</div>

    
<br>
        <div class="card">
    <div class="card-content">
        <h1 class="title is-5">Archives</h1>
        
            <a href="https://ahojukka5.github.io/archives/2020">2020</a> (15)<br>
        
            <a href="https://ahojukka5.github.io/archives/2019">2019</a> (4)<br>
        
    </div>
</div>

    </div>
</div>


    </div>
</div>

<footer class="footer has-background-grey-darker has-text-white">
    <div class="content has-text-centered">
        <p>
            <span class="icon is-large"><a href="https://twitter.com/" class="mysocial" rel="me"><i class="fab fa-twitter fa-3x"></i></a></span>&nbsp;&nbsp;
            <span class="icon is-large"><a href="https://www.youtube.com/" class="mysocial" rel="me"><i class="fab fa-youtube fa-3x"></i></a></span>&nbsp;&nbsp;
            <span class="icon is-large"><a href="https://github.com/" class="mysocial" rel="me"><i class="fab fa-github fa-3x"></i></a></span>&nbsp;&nbsp;
            <br><br>
            Copyright &copy; Jukka Aho (@ahojukka5) 2020 - Theme by <a href="https://jeffprod.com" class="mysocial">JeffProd.com</a>
            - <a class="mysocial" href="https://ahojukka5.github.io/about">About</a>
        </p>
    </div>
</footer>

<script defer src="https://use.fontawesome.com/releases/v5.1.0/js/all.js"></script>
</body>
</html>
